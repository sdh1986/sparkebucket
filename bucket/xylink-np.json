{
    "version": "3.10.10.27298",
    "description": "小鱼易连会议软件 (便携版)",
    "homepage": "https://www.xylink.com",
    "license": "Unknown",
    "url": "https://cdn.xylink.com/as/150130/new/XYLinkClient-3.10.10.27298.exe",
    "hash": "7178aa616557b2a083953de59158b97ab0fdad98e278e48ff96fbccb04741e7d",
    "installer": {
        "script": [
            "# 静默安装到临时目录",
            "$tempDir = \"$env:TEMP\\XYLink_temp_$((Get-Random))\"",
            "Start-Process -Wait -FilePath \"$dir\\XYLinkClient-$version.exe\" -ArgumentList \"/VERYSILENT\", \"/SUPPRESSMSGBOXES\", \"/NORESTART\", \"/DIR=$tempDir\" -Verb RunAs",
            "",
            "# 等待安装完成",
            "Start-Sleep -Seconds 3",
            "",
            "# 复制文件到 Scoop 目录",
            "if (Test-Path \"$tempDir\\XYWinQT\") {",
            "    Copy-Item -Path \"$tempDir\\XYWinQT\\*\" -Destination \"$dir\" -Recurse -Force",
            "}",
            "elseif (Test-Path 'C:\\Program Files (x86)\\XYLink\\XYWinQT') {",
            "    Copy-Item -Path 'C:\\Program Files (x86)\\XYLink\\XYWinQT\\*' -Destination \"$dir\" -Recurse -Force",
            "}",
            "",
            "# 卸载系统安装的版本",
            "if (Test-Path \"$tempDir\\XYWinQT\\unins000.exe\") {",
            "    Start-Process -Wait -FilePath \"$tempDir\\XYWinQT\\unins000.exe\" -ArgumentList \"/VERYSILENT\" -Verb RunAs",
            "}",
            "elseif (Test-Path 'C:\\Program Files (x86)\\XYLink\\XYWinQT\\unins000.exe') {",
            "    Start-Process -Wait -FilePath 'C:\\Program Files (x86)\\XYLink\\XYWinQT\\unins000.exe' -ArgumentList \"/VERYSILENT\" -Verb RunAs",
            "}",
            "",
            "# 清理",
            "Remove-Item \"$tempDir\" -Recurse -Force -ErrorAction SilentlyContinue",
            "Remove-Item \"$dir\\XYLinkClient-$version.exe\" -ErrorAction SilentlyContinue",
            "Remove-Item \"$dir\\unins000.exe\", \"$dir\\unins000.dat\" -ErrorAction SilentlyContinue"
        ]
    },
    "bin": "XYLink.exe",
    "shortcuts": [
        [
            "XYLink.exe",
            "小鱼易连 (便携版)"
        ]
    ],
    "persist": [
        "config",
        "userdata",
        "logs"
    ],
    "checkver": {
        "url": "https://cloud.xylink.com/api/rest/en/version?platform=desktop_pc&vcsSource=home",
        "regex": "\"appUrl\":\"https://cdn.xylink.com/as/\\d+/new/XYLinkClient-(?<patch>\\d+.\\d+\\.\\d+\\.\\d+).exe",
        "replace": "${patch}"
    },
    "autoupdate": {
        "url": "https://cdn.xylink.com/as/150130/new/XYLinkClient-$version.exe",
        "hash": {
            "mode": "download"
        }
    }
}
