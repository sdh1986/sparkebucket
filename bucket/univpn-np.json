{
    "version": "10781.18.1.0512",
    "description": "UniVPN Client 远程接入终端方案",
    "homepage": "https://www.leagsoft.com/",
    "license": {
        "identifier": "Proprietary",
        "url": "https://www.leagsoft.com/doc/article/103107.html"
    },
    "url": "https://download.leagsoft.com/download/UniVPN/win/univpn-win-full-10781.18.1.0512-signed.zip",
    "hash": "388575f847c7dbe24b6bd654a654d2ea91ab46193b514a10f2f35d4d190d9d07",
    "installer": {
        "script": [
            "Expand-Archive -Path \"$dir\\$fname\" -DestinationPath \"$dir\" -Force",
            "$exe = (Get-ChildItem -Path \"$dir\" -Filter '*.exe' -Recurse | Select-Object -First 1).FullName",
            "Start-Process -Wait -FilePath $exe -ArgumentList '/S' -Verb RunAs | Out-Null"
        ]
    },
    "uninstaller": {
        "script": [
            "$paths = 'HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*', 'HKLM:\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\*'",
            "$app = Get-ItemProperty $paths -ErrorAction SilentlyContinue | Where-Object { $_.DisplayName -match 'UniVPN' } | Select-Object -First 1",
            "if ($app) {",
            "    $uninst = $app.UninstallString",
            "    if ($uninst) {",
            "        $uninst = $uninst -replace ' /S$', ''",
            "        Invoke-Expression \"& `\"$uninst`\" /S\"",
            "    }",
            "}",
            "else {",
            "    Write-Warning 'Could not find UniVPN in the list of installed programs.'",
            "}"
        ]
    },
    "checkver": {
        "url": "https://www.leagsoft.com/doc/article/103107.html",
        "regex": "(?<patch>\\d+\\.\\d+\\.\\d+\\.\\d+)"
    },
    "autoupdate": {
        "url": "https://download.leagsoft.com/download/UniVPN/win/univpn-win-full-$version-signed.zip",
        "hash": {
            "mode": "download"
        }
    }
}
