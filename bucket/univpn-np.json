{
    "version": "10781.18.1.0512",
    "description": "UniVPN Client 远程接入终端方案",
    "homepage": "https://www.leagsoft.com/",
    "license": {
        "identifier": "Proprietary",
        "url": "https://www.leagsoft.com/doc/article/103107.html"
    },
    "url": "https://download.leagsoft.com/download/UniVPN/win/univpn-win-full-10781.18.1.0512-signed.zip",
    "hash": "388575f847c7dbe24b6bd654a654d2ea91ab46193b514a10f2f35d4d190d9d07",
    "installer": {
        "script": [
            "Start-Process -Wait -FilePath (Get-ChildItem -Path \"$dir\" -Filter '*.exe' -Recurse | Select-Object -First 1).FullName -ArgumentList '/S' -Verb RunAs | Out-Null"
        ]
    },
    "uninstaller": {
        "script": [
            "$tapAdapters = Get-PnpDevice -Class Net -FriendlyName 'TAP-Windows Adapter V9' -ErrorAction SilentlyContinue",
            "if ($tapAdapters) {",
            "    Write-Host 'Found TAP-Windows Adapter V9. Attempting to uninstall...'",
            "    foreach ($adapter in $tapAdapters) {",
            "        $instanceId = $adapter.InstanceID",
            "        Write-Host \"Uninstalling device with Instance ID: $instanceId\"",
            "        Start-Process -Wait -FilePath 'pnputil.exe' -ArgumentList \"/remove-device `\"$instanceId`\"\" -Verb RunAs | Out-Null",
            "    }",
            "} else {",
            "    Write-Host 'TAP-Windows Adapter V9 not found.' -ForegroundColor Yellow",
            "}",
            "$uninstallerPath = \"C:\\Program Files (x86)\\UniVPN\\uninst.exe\"",
            "if (Test-Path $uninstallerPath) {",
            "    Write-Host 'Running UniVPN uninstaller from default path...'",
            "    Start-Process -Wait -FilePath $uninstallerPath -ArgumentList '/S' -Verb RunAs | Out-Null",
            "} else {",
            "    Write-Host \"UniVPN uninstaller also not found at default path: '$uninstallerPath'\" -ForegroundColor Red",
            "}"
        ]
    },
    "checkver": {
        "url": "https://www.leagsoft.com/doc/article/103107.html",
        "regex": "(?<patch>\\d+\\.\\d+\\.\\d+\\.\\d+)"
    },
    "autoupdate": {
        "url": "https://download.leagsoft.com/download/UniVPN/win/univpn-win-full-$version-signed.zip",
        "hash": {
            "mode": "download"
        }
    }
}
